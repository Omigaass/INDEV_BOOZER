<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="CSS/ABRE_LOGIN.CSS">
    <link rel="stylesheet" href="CSS/MAIN.CSS">
    <link rel="stylesheet" media="screen" href="https://fontlibrary.org//face/bilbo" type="text/css" />
    <title>Boozer</title>
</head>
<body>
    <div class="fullscreen">
        <main class="main_sec">
            <div class="left_sec">
                <span class="title">Bem vindo ao Boozer!</span>
                <span class="subtitle">Faça seu login para explorar nossas coleções e encontrar seu próximo livro favorito.</span>
            </div>
            <div class="right_sec">
                <div class="login_sec">
                    <form id="loginForm" class="login_card">
                        <div class="textfield">
                            <label class="label" for="username">Usuário</label>
                            <input class="input" type="text" id="username" required>
                        </div>
                        <div class="textfield">
                            <label class="label" for="password">Senha</label>
                            <input class="input" type="password" id="password" required>
                        </div>
                        <div class="login_btn_sec">
                            <button type="submit" class="btn_login">Login</button>
                        </div>
                        <div class="login_menu"><a href="ABRE_LOGON.html" class="register">Não tem conta?</a></div>
                    </form>
                </div>
            </div>
        </main>
    </div>
</body>
<script>
    document.getElementById("loginForm").addEventListener("submit", function (e) {
        e.preventDefault();

        var username = document.getElementById("username").value;
        var password = document.getElementById("password").value;

        if (username === "" && password === "") {
            window.location.href = "ABRE_MENU.html";
        } else {
            alert("Tente deixar os campos vazios.");
        }
    });
</script>
</html>

<!-- //package hermanos.api;

import java.io.IOException;
import java.net.URLDecoder;
import java.sql.CallableStatement;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Types;
import java.util.Base64;
import java.util.Enumeration;

import javax.json.Json;
import javax.json.JsonObjectBuilder;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/auth")
public class HermanosAuth extends HttpServlet {
  @Override
  protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
    resp.getWriter().println("esta vivo esta vivo ");
    super.doGet(req, resp);
  }

  @Override
  public void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {
    response.setContentType("application/json");
    JsonObjectBuilder sendData = Json.createObjectBuilder();
    final String gType = request.getParameter("grant_type")==null?"fail":request.getParameter("grant_type");
    if (gType.equals("client_credentials")){
      try{
        boolean allOK = false;
        Enumeration<String> e =  request.getHeaderNames();
        int k=0;
        while (e.hasMoreElements()) {
          final String kType =e.nextElement();
          //sendData.add("header"+Integer.toString(k++),kType);
          if (kType.equals("Authorization")||kType.equals("authorization")) {
            allOK = true;
            final String bearerFull = request.getHeader("Authorization");
            //final String cnpj = request.getHeader("cnpj");
            if (!bearerFull.contains("Basic")){
              sendData.add("mensagem","Erro, Favor verificar as instru\u00e7\u00f5es da API basic");
            } else {
              final String vurl = request.getRequestURL().toString();
              final int posicao = vurl.indexOf('.');
              //final String cd_empresa = vurl.substring(7,posicao).toUpperCase();
              final String cd_empresa = "LOCALHOST";
              final String[] kuko = new String(Base64.getMimeDecoder().decode(URLDecoder.decode(bearerFull.replaceAll("Basic ",""),"UTF-8"))).split(":");
              final String login = kuko[0].replace(":","");
              final String senha = kuko[1].replace(":","");
              final String DRIVER = "oracle.jdbc.driver.OracleDriver";
              final String DB_URL = "jdbc:oracle:thin:@10.133.0.70:1521:SIGCB";
              final String DB_USER = "BENEFICIO";
              final String DB_PASSWORD = "Hermanos1981";
              Connection connection = null;
              CallableStatement pstatement = null;
              try {
                Class.forName(DRIVER);
                connection = DriverManager.getConnection(DB_URL,DB_USER,DB_PASSWORD);
                pstatement = connection.prepareCall("BEGIN PKG_API_BENEFICIO.GET_TOKEN(?,?,?,?); END;");
                pstatement.setString(1,login);
                pstatement.setString(2,senha);
                pstatement.setString(3,cd_empresa.equals("LOCALHOST")?"DEMONSTRACAO":cd_empresa);
                pstatement.registerOutParameter(4,Types.VARCHAR);
                pstatement.execute();
                final String token = pstatement.getString(4).trim();
                pstatement.close();
                connection.close();
                if (token.equals("E")||token.contains("ORA")){
                  sendData.add("mensagem","Erro geral, Favor verificar todos os headers do envio.");
                } else if (token.equals("F")){
                  sendData.add("mensagem","Acesso negado. Empresa não cadastrada no sistema. Favor verificar a veracidade dos headers enviados");
                } else {
                  sendData.add("accessToken",token);
                }
              } catch (SQLException ex) {  // handle any errors
                response.getWriter().println("SQLException: " + ex.getMessage());
                response.getWriter().println("SQLState: " + ex.getSQLState());
                response.getWriter().println("VendorError: " + ex.getErrorCode());
                try {
                  pstatement.close();
                } catch (SQLException e2) {
                  response.getWriter().println("VendorError: " + e2.getMessage());
                  response.getWriter().println("SQLState: " + e2.getSQLState());
                  response.getWriter().println("VendorError: " + e2.getErrorCode());
                }
                try {
                  connection.close();
                } catch (SQLException e3) {
                  response.getWriter().println("VendorError: " + e3.getMessage());
                  response.getWriter().println("SQLState: " + e3.getSQLState());
                  response.getWriter().println("VendorError: " + e3.getErrorCode());
                }
              } catch (ClassNotFoundException cnfex) {
                response.getWriter().println("SQLException: " + cnfex.getMessage());
                //response.getWriter().println("SQLState: " + cnfex.getSQLState());
                //response.getWriter().println("VendorError: " +cnfex.getErrorCode());
              }
              /** */
            }
          }
        }
        if (!allOK) sendData.add("mensagem","Erro, Favor verificar as instru\u00e7\u00f5es da API geral");
      } catch (Exception eex) {
        response.getWriter().println("Exception??: " + eex.getMessage());
        //response.getWriter().println("SQLState: " + eex.getSQLState());
        //response.getWriter().println("VendorError: " +eex.getErrorCode());
      }
    } else {
      sendData.add("mensagem","Erro, Favor verificar as instru\u00e7\u00f5es da API credencial "+gType);
    }
    response.getWriter().println(sendData.build().toString());
  }
} -->
